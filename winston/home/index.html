<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬ä¼—å·ä¸€é”®æ’ç‰ˆç¥å™¨</title>
    <style>
        /* å·¥å…·æœ¬èº«çš„ç•Œé¢æ ·å¼ (UI) */
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f4f5f7; height: 100vh; display: flex; flex-direction: column; }
        header { background-color: #07c160; color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 20px; font-weight: 500; }
        
        .container { flex: 1; display: flex; padding: 20px; gap: 20px; overflow: hidden; }
        
        /* å·¦ä¾§è¾“å…¥åŒº */
        .editor-box { flex: 1; display: flex; flex-direction: column; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .box-header { padding: 15px; border-bottom: 1px solid #eee; font-weight: bold; color: #555; display: flex; justify-content: space-between; }
        textarea { flex: 1; border: none; padding: 20px; font-size: 16px; line-height: 1.6; resize: none; outline: none; font-family: Consolas, "Courier New", monospace; color: #333; }
        
        /* å³ä¾§é¢„è§ˆåŒº */
        .preview-box { flex: 1; display: flex; flex-direction: column; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        #preview { flex: 1; padding: 40px; overflow-y: auto; background-color: #fff; border: 1px solid #eee; }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn { padding: 8px 16px; border-radius: 4px; border: none; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .btn-primary { background-color: #07c160; color: white; }
        .btn-primary:hover { background-color: #06ad56; }
        .btn-outline { background-color: transparent; border: 1px solid #ddd; color: #666; }
        .btn-outline:hover { background-color: #f9f9f9; }

        /* æ‰‹æœºæ¨¡æ‹Ÿæ¡† (ä¸ºäº†é¢„è§ˆçœŸå®æ•ˆæœ) */
        .mobile-wrapper {
            width: 375px; /* iPhone å®½ */
            margin: 0 auto;
            min-height: 100%;
            background: #fff;
            /* æ¨¡æ‹Ÿå¾®ä¿¡ç¯å¢ƒå­—ä½“ */
            font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;
        }

        /* æç¤ºä¿¡æ¯ */
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); color: white; padding: 10px 20px; border-radius: 50px; font-size: 14px; display: none; z-index: 1000; }
    </style>
</head>
<body>

<header>
    <h1>ğŸª„ å…¬ä¼—å·ä¸€é”®æ’ç‰ˆå·¥å…·</h1>
    <div>
        <button class="btn btn-outline" onclick="loadDemo()">åŠ è½½ç¤ºä¾‹æ–‡æœ¬</button>
        <button class="btn btn-primary" onclick="copyToWeChat()">ğŸ“‹ ä¸€é”®å¤åˆ¶ (å»å…¬ä¼—å·ç²˜è´´)</button>
    </div>
</header>

<div class="container">
    <div class="editor-box">
        <div class="box-header">
            <span>ğŸ“Markdown / æ–‡æœ¬è¾“å…¥</span>
            <span style="font-size:12px; font-weight:normal; color:#999;">æ”¯æŒ **åŠ ç²—** å’Œ ## æ ‡é¢˜</span>
        </div>
        <textarea id="input" placeholder="è¯·åœ¨æ­¤å¤„ç²˜è´´ä½ çš„æ–‡ç« å†…å®¹...&#10;&#10;ä½¿ç”¨æŠ€å·§ï¼š&#10;1. è¾“å…¥ ## æ ‡é¢˜ æ–‡å­— (äºŒçº§æ ‡é¢˜)&#10;2. è¾“å…¥ **é‡ç‚¹æ–‡å­—** (åŠ ç²—)&#10;3. æ¯ä¸€æ®µä¹‹é—´ç©ºä¸€è¡Œ"></textarea>
    </div>

    <div class="preview-box">
        <div class="box-header">
            <span>ğŸ“± æ•ˆæœé¢„è§ˆ (å·²åº”ç”¨æ ·å¼)</span>
        </div>
        <div id="preview-container" style="flex:1; overflow-y:auto; background:#f5f5f5; padding: 20px 0;">
            <div id="preview" class="mobile-wrapper">
                </div>
        </div>
    </div>
</div>

<div id="toast">å·²å¤åˆ¶ï¼è¯·ç›´æ¥å»å¾®ä¿¡åå°æŒ‰ Ctrl+V ç²˜è´´</div>

<script>
    // === æ ¸å¿ƒæ’ç‰ˆé…ç½® (CSSæ ·å¼å®šä¹‰) ===
    const STYLES = {
        // å…¨å±€å®¹å™¨
        container: `font-size: 15px; color: #3f3f3f; line-height: 1.75; letter-spacing: 1px; text-align: justify; padding: 10px; box-sizing: border-box;`,
        
        // äºŒçº§æ ‡é¢˜ (##)
        h2: `display: block; font-size: 18px; font-weight: bold; color: #333; margin-top: 35px; margin-bottom: 15px; border-left: 4px solid #07c160; padding-left: 10px; line-height: 1.4;`,
        
        // ä¸‰çº§æ ‡é¢˜ (###)
        h3: `display: block; font-size: 16px; font-weight: bold; color: #333; margin-top: 25px; margin-bottom: 10px; text-align: center;`,
        
        // æ­£æ–‡æ®µè½
        p: `margin: 0 0 20px 0; font-size: 15px; color: #3f3f3f; line-height: 1.8; text-align: justify; word-break: break-all;`,
        
        // åŠ ç²—æ–‡å­— (**text**)
        strong: `font-weight: bold; color: #07c160;`, // é‡ç‚¹è‰²è®¾ä¸ºå¾®ä¿¡ç»¿ï¼Œå¯è‡ªè¡Œä¿®æ”¹
        
        // å¼•ç”¨å— (> text)
        quote: `display: block; background: #f7f7f7; border-left: 4px solid #d3d3d3; color: #888; padding: 15px; margin: 20px 0; font-size: 14px; line-height: 1.6; border-radius: 0 4px 4px 0;`,
        
        // åˆ—è¡¨
        li: `margin-bottom: 8px; font-size: 15px; line-height: 1.75;`,

        // åˆ†å‰²çº¿ (---)
        hr: `border: 0; border-top: 1px solid #eee; margin: 30px 0;`
    };

    const inputArea = document.getElementById('input');
    const previewArea = document.getElementById('preview');

    // ç›‘å¬è¾“å…¥ï¼Œå®æ—¶æ¸²æŸ“
    inputArea.addEventListener('input', render);

    function render() {
        const text = inputArea.value;
        const html = parseMarkdown(text);
        previewArea.innerHTML = `<section style="${STYLES.container}">${html}</section>`;
    }

    // === ç®€å•çš„ Markdown è§£æå™¨ (è½¬ä¸ºå¸¦ Inline CSS çš„ HTML) ===
    function parseMarkdown(text) {
        if (!text) return '';
        
        let lines = text.split('\n');
        let html = '';
        let inList = false;

        lines.forEach(line => {
            line = line.trim();
            
            // 1. å¤„ç†åˆ†å‰²çº¿
            if (line === '---' || line === '***') {
                html += `<hr style="${STYLES.hr}" />`;
                return;
            }

            // 2. å¤„ç†æ ‡é¢˜ (## H2, ### H3)
            if (line.startsWith('## ')) {
                html += `<h2 style="${STYLES.h2}">${processInline(line.substring(3))}</h2>`;
                return;
            }
            if (line.startsWith('### ')) {
                html += `<h3 style="${STYLES.h3}">${processInline(line.substring(4))}</h3>`;
                return;
            }

            // 3. å¤„ç†å¼•ç”¨ (> Quote)
            if (line.startsWith('> ')) {
                html += `<blockquote style="${STYLES.quote}">${processInline(line.substring(2))}</blockquote>`;
                return;
            }

            // 4. å¤„ç†åˆ—è¡¨ (- List)
            if (line.startsWith('- ') || line.startsWith('* ')) {
                if (!inList) { html += '<ul>'; inList = true; }
                html += `<li style="${STYLES.li}">${processInline(line.substring(2))}</li>`;
                return;
            } else {
                if (inList) { html += '</ul>'; inList = false; }
            }

            // 5. å¤„ç†ç©ºè¡Œå’Œæ™®é€šæ®µè½
            if (line === '') {
                // ç©ºè¡Œä¸å¤„ç†ï¼Œä¾é æ®µè½çš„ margin-bottom
            } else {
                html += `<p style="${STYLES.p}">${processInline(line)}</p>`;
            }
        });

        if (inList) html += '</ul>';
        return html;
    }

    // å¤„ç†è¡Œå†…æ ·å¼ (åŠ ç²—ã€å›¾ç‰‡)
    function processInline(text) {
        // æ›¿æ¢å›¾ç‰‡ ![alt](url) -> <img ...>
        text = text.replace(/!\[(.*?)\]\((.*?)\)/g, `<img src="$2" style="max-width:100%; height:auto; display:block; margin: 10px auto; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" />`);
        
        // æ›¿æ¢åŠ ç²— **text** -> <strong ...>
        text = text.replace(/\*\*(.*?)\*\*/g, `<strong style="${STYLES.strong}">$1</strong>`);
        
        return text;
    }

    // === å¤åˆ¶åŠŸèƒ½ (æ ¸å¿ƒ) ===
    function copyToWeChat() {
        const range = document.createRange();
        range.selectNode(previewArea); // é€‰ä¸­é¢„è§ˆåŒºåŸŸ
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        
        try {
            document.execCommand('copy'); // æ‰§è¡Œå¤åˆ¶
            showToast();
        } catch (err) {
            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰ä¸­å³ä¾§å†…å®¹å¤åˆ¶');
        }
        
        selection.removeAllRanges(); // å–æ¶ˆé€‰ä¸­çŠ¶æ€
    }

    function showToast() {
        const toast = document.getElementById('toast');
        toast.style.display = 'block';
        setTimeout(() => { toast.style.display = 'none'; }, 2000);
    }

    function loadDemo() {
        inputArea.value = `## è¿™é‡Œæ˜¯ä¸»æ ‡é¢˜
è¿™æ˜¯æ­£æ–‡å†…å®¹ã€‚å­—å·å·²ç»è‡ªåŠ¨è®¾ç½®ä¸º15pxï¼Œé¢œè‰²ä¸ºæ·±ç°è‰²ï¼ˆ#3f3f3fï¼‰ï¼Œé•¿æ—¶é—´é˜…è¯»ä¸ç´¯çœ¼ã€‚è¡Œé—´è·è®¾ç½®ä¸º1.75ï¼Œå‘¼å¸æ„Ÿå¾ˆè¶³ã€‚

> è¿™é‡Œæ˜¯ä¸€æ®µå¼•ç”¨å†…å®¹ï¼Œé€‚åˆç”¨æ¥æ”¾é‡‘å¥æˆ–è€…åè¯è§£é‡Šã€‚

## ä¸ºä»€ä¹ˆæ’ç‰ˆå¾ˆé‡è¦ï¼Ÿ
1. **æå‡é˜…è¯»ä½“éªŒ**ï¼šä¹±ç³Ÿç³Ÿçš„æ’ç‰ˆæ²¡äººæ„¿æ„çœ‹ã€‚
2. **å»ºç«‹ä¸“ä¸šæ„Ÿ**ï¼šå¥½çš„æ’ç‰ˆä»£è¡¨äº†æ€åº¦ã€‚
3. **å¼•å¯¼è§†çº¿**ï¼šé€šè¿‡æ ‡é¢˜å’ŒåŠ ç²—ï¼Œè®©è¯»è€…å¿«é€ŸGeté‡ç‚¹ã€‚

è¿™æ˜¯æœ€åä¸€æ®µï¼Œæµ‹è¯•ä¸€ä¸‹æ®µè½é—´è·ã€‚`;
        render();
    }

    // åˆå§‹åŒ–æ¸²æŸ“
    render();
</script>

</body>
</html>